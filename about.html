<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About DISCERN Protocol - Dual Pathway Framework</title>
    
    <!-- Desktop Enhancement Framework -->
    <link rel="stylesheet" href="desktop-enhancements.css">
    
    <script src="theme-system.js"></script>
    <style>
        :root {
            /* Light Theme Variables */
            --bg-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --bg-secondary: rgba(255, 255, 255, 0.98);
            --bg-glass: rgba(255, 255, 255, 0.25);
            --bg-glass-hover: rgba(255, 255, 255, 0.35);
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --text-tertiary: #6b7280;
            --border-color: rgba(102, 126, 234, 0.2);
            --shadow-color: rgba(0, 0, 0, 0.1);
            --shadow-hover: rgba(102, 126, 234, 0.3);
            --backdrop-blur: blur(20px);
        }

        [data-theme="dark"] {
            /* Dark Theme Variables - WCAG AA+ Compliant */
            --bg-primary: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --bg-secondary: rgba(15, 23, 42, 0.98);
            --bg-glass: rgba(30, 41, 59, 0.85);
            --bg-glass-hover: rgba(30, 41, 59, 0.95);
            --card-bg: rgba(30, 41, 59, 0.95);
            /* High contrast text colors for accessibility */
            --text-primary: #ffffff;
            --text-secondary: #f1f5f9;
            --text-tertiary: #e2e8f0;
            --text-on-glass: #ffffff;
            --text-hover: #c4b5fd;
            --border-color: rgba(203, 213, 225, 0.3);
            --shadow-color: rgba(0, 0, 0, 0.4);
            --shadow-hover: rgba(196, 181, 253, 0.4);
            --backdrop-blur: blur(20px);
            --accent-primary: #a78bfa;
            --accent-secondary: #8b5cf6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-primary);
            min-height: 100vh;
            color: var(--text-secondary);
            overflow-x: auto;
            transition: all 0.3s ease;
        }

        /* Theme Toggle in Header */
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1100;
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--border-color);
            border-radius: 50px;
            padding: 12px 16px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: var(--text-primary);
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px var(--shadow-color);
            width: auto;
            max-width: fit-content;
        }

        .theme-toggle:hover {
            background: var(--bg-glass-hover);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow-hover);
        }

        .theme-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover .theme-icon {
            transform: scale(1.1);
        }

        /* Dynamic Navigation */
        nav {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            padding: 15px;
            box-shadow: 0 2px 10px var(--shadow-color);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }

        .nav-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .nav-link {
            text-decoration: none;
            color: var(--text-secondary);
            font-weight: 600;
            padding: 8px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .nav-link:hover {
            background: var(--bg-glass-hover);
            color: var(--text-hover);
        }

        .nav-link.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: default;
        }

        .nav-link.active:hover {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .ai-nav-link {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 10px 20px;
            font-weight: 700;
            box-shadow: 0 2px 10px rgba(16, 185, 129, 0.3);
        }

        .ai-nav-link:hover {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: white;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(16, 185, 129, 0.4);
        }

        .framework-container {
            /* Responsive sizing handled by desktop-enhancements.css */
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            color: white;
        }

        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            color: white;
        }

        .workflow {
            display: grid;
            margin-bottom: 40px;
        }

        .phase-card {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid var(--border-color);
            box-shadow: 0 10px 30px var(--shadow-color);
            transition: all 0.3s ease;
            position: relative;
            cursor: pointer;
        }

        .phase-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px var(--shadow-hover);
            background: var(--bg-glass-hover);
        }

        .phase-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }

        .phase-number {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            margin-right: 15px;
            font-size: 1.2rem;
        }

        .phase-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--text-primary);
        }

        .phase-subtitle {
            font-size: 0.9rem;
            color: var(--text-tertiary);
        }

        .cognitive-enhancements {
            margin-bottom: 20px;
        }

        .cognitive-enhancements h4 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .enhancement-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .enhancement-tag {
            background: var(--bg-glass);
            color: var(--accent-primary);
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            border: 1px solid var(--border-color);
        }

        [data-theme="dark"] .enhancement-tag {
            background: var(--bg-glass-hover);
            color: var(--accent-primary);
        }

        .key-processes {
            margin-bottom: 20px;
        }

        .key-processes h4 {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .process-list {
            list-style: none;
        }

        .process-list li {
            padding: 8px 0;
            padding-left: 20px;
            position: relative;
            font-size: 0.9rem;
            line-height: 1.4;
            color: var(--text-secondary);
        }

        .process-list li::before {
            content: "‚Üí";
            position: absolute;
            left: 0;
            color: var(--accent-primary);
            font-weight: bold;
        }

        .metrics {
            background: var(--bg-glass);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            border: 1px solid var(--border-color);
        }

        .metrics h4 {
            font-size: 0.9rem;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .metric-bar {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .metric-label {
            font-size: 0.8rem;
            min-width: 120px;
            color: var(--text-secondary);
        }

        .metric-visual {
            flex: 1;
            height: 6px;
            background: var(--border-color);
            border-radius: 3px;
            margin: 0 10px;
            position: relative;
        }

        .metric-fill {
            height: 100%;
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        .metric-value {
            font-size: 0.8rem;
            font-weight: bold;
            color: var(--text-primary);
            min-width: 30px;
        }

        /* Phase-specific colors */
        .recognize { background: linear-gradient(135deg, #fef3c7, #f59e0b); }
        .examine { background: linear-gradient(135deg, #ddd6fe, #8b5cf6); }
        .prepare { background: linear-gradient(135deg, #fecaca, #ef4444); }
        .articulate { background: linear-gradient(135deg, #bbf7d0, #10b981); }
        .implement { background: linear-gradient(135deg, #bfdbfe, #3b82f6); }
        .restore { background: linear-gradient(135deg, #fed7ff, #d946ef); }

        .enhancement-matrix {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px var(--shadow-color);
            margin-bottom: 30px;
            border: 1px solid var(--border-color);
        }

        .matrix-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: var(--text-primary);
        }

        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .matrix-table th,
        .matrix-table td {
            padding: 12px 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }

        .matrix-table th {
            background: var(--bg-glass-hover);
            font-weight: bold;
            color: var(--text-primary);
        }

        .matrix-table td {
            background: var(--bg-glass);
            color: var(--text-secondary);
        }

        .matrix-value {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
        }

        .value-high { background: #10b981; }
        .value-medium { background: #f59e0b; }
        .value-low { background: #6b7280; }

        .activation-panel {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px var(--shadow-color);
            margin-bottom: 20px;
            border: 1px solid var(--border-color);
        }

        .activation-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--text-primary);
        }

        .activation-commands {
            background: var(--bg-secondary);
            color: var(--text-primary);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
            border: 1px solid var(--border-color);
        }

        .command-line {
            margin-bottom: 5px;
        }

        .command-prompt {
            color: var(--accent-primary);
        }

        .expanded-details {
            display: none;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .expanded-details.show {
            display: block;
        }

        .detail-section {
            margin-bottom: 20px;
        }

        .detail-section h5 {
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .detail-list {
            list-style: none;
            padding-left: 0;
        }

        .detail-list li {
            padding: 6px 0;
            padding-left: 15px;
            position: relative;
            font-size: 0.85rem;
            line-height: 1.4;
            color: var(--text-secondary);
        }

        .detail-list li::before {
            content: "‚Ä¢";
            position: absolute;
            left: 0;
            color: var(--accent-primary);
            font-weight: bold;
        }

        .expand-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.3s ease;
            margin-top: 10px;
        }

        .expand-btn:hover {
            background: var(--accent-secondary);
        }

        /* Additional dark mode text fixes */
        [data-theme="dark"] .container,
        [data-theme="dark"] .feature-card,
        [data-theme="dark"] .mode-toggle-section,
        [data-theme="dark"] .disclaimer {
            color: var(--text-secondary);
        }

        [data-theme="dark"] .container h1,
        [data-theme="dark"] .container h2,
        [data-theme="dark"] .container h3,
        [data-theme="dark"] .feature-title,
        [data-theme="dark"] .disclaimer-title,
        [data-theme="dark"] .phase-title,
        [data-theme="dark"] .matrix-title,
        [data-theme="dark"] .activation-title {
            color: var(--text-primary) !important;
        }

        @media (max-width: 768px) {
            .workflow {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .matrix-table {
                font-size: 0.8rem;
            }
            
            .phase-card {
                padding: 20px;
            }

            .theme-toggle {
                padding: 10px 14px;
                font-size: 0.8rem;
            }
        }

        .emoji {
            font-style: normal;
        }

        /* Floating Chat Button */
        .floating-chat-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            font-size: 2rem;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            animation: pulse-heart 2s infinite;
        }

        @keyframes pulse-heart {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .floating-chat-button:hover {
            transform: scale(1.15);
            box-shadow: 0 12px 32px rgba(102, 126, 234, 0.6);
        }

        .floating-chat-button.hidden {
            display: none;
        }

        .chat-widget-panel {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 400px;
            height: 600px;
            background: var(--bg-secondary);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            transform: translateY(calc(100% + 60px));
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 999;
            overflow: hidden;
        }

        .chat-widget-panel.active {
            transform: translateY(0);
            opacity: 1;
        }

        .chat-widget-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 20px 20px 0 0;
        }

        .chat-header-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .chat-icon {
            font-size: 1.5rem;
        }

        .chat-header-actions {
            display: flex;
            gap: 0.5rem;
        }

        .chat-action-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            font-size: 1.2rem;
        }

        .chat-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .chat-widget-body {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 0;
            background: var(--bg-secondary);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            background: transparent;
            min-height: 300px;
            max-height: 400px;
        }

        .chat-message {
            display: flex;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            align-items: flex-start;
        }

        .chat-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .chat-avatar.assistant {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .chat-avatar.user {
            background: linear-gradient(135deg, #6b7280 0%, #4b5563 100%);
        }

        .chat-bubble {
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            padding: 0.875rem 1.125rem;
            border-radius: 16px;
            max-width: 75%;
            line-height: 1.5;
            color: var(--text-primary);
        }

        .chat-bubble.assistant {
            border-top-left-radius: 4px;
        }

        .chat-bubble.user {
            border-top-right-radius: 4px;
            margin-left: auto;
        }

        .chat-input-area {
            padding: 0 1rem 1rem 1rem;
            background: var(--bg-secondary);
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background: var(--bg-glass);
            backdrop-filter: var(--backdrop-blur);
            color: var(--text-primary);
            font-size: 0.95rem;
            resize: none;
            min-height: 80px;
            font-family: inherit;
            transition: all 0.2s ease;
        }

        .chat-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .chat-input::placeholder {
            color: var(--text-tertiary);
        }

        .send-button {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            transition: all 0.2s ease;
            flex-shrink: 0;
            align-self: flex-end;
        }

        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            .chat-widget-panel {
                width: calc(100vw - 40px);
                height: calc(100vh - 40px);
                bottom: 20px;
                right: 20px;
            }

            .floating-chat-button {
                bottom: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Button -->
    <div class="theme-toggle" onclick="toggleTheme()">
        <span class="theme-icon" id="theme-icon">üåô</span>
        <span id="theme-text">Dark Mode</span>
    </div>

    <nav class="navigation desktop-center">
        <div class="nav-container desktop-center">
            <a href="index.html" class="nav-link">
                <span class="emoji">üè†</span> Home
            </a>
            <a href="repair.html" class="nav-link">
                <span class="emoji">üîß</span> REPAIR Protocol
            </a>
            <span class="nav-link active">
                <span class="emoji">üìä</span> Visual Framework
            </span>
            <a href="progress.html" class="nav-link">
                <span class="emoji">üìà</span> Progress
            </a>
            <a href="mediation-mode.html" class="nav-link">
                <span class="emoji">ü§ù</span> Mediation
            </a>
            <a href="sign-contract.html" class="nav-link">
                <span class="emoji">‚úçÔ∏è</span> Sign Contract
            </a>
            <a href="api-quickstart.html" class="nav-link">
                <span class="emoji">üìö</span> API Guide
            </a>
            <a href="https://chatgpt.com/g/g-685f7ec1cae4819183b514fdeff27b43-discern-bot-relationship-navigation-coach"
               class="nav-link ai-nav-link"
               target="_blank"
               rel="noopener noreferrer">
                <span class="emoji">ü§ñ</span> AI Coach
            </a>
        </div>
    </nav>

    <div class="framework-container desktop-center responsive-padding">
        <div class="header header-section desktop-center responsive-padding">
            <h1>REPAIR Pathway</h1>
            <div class="subtitle">Reconciliation & Emotional Process for Apology, Integration, & Restoration | DISCERN Protocol</div>
        </div>

        <div class="workflow features-grid desktop-center">
            <!-- Phase 1: RECOGNIZE -->
            <div class="phase-card" onclick="toggleDetails('recognize')">
                <div class="phase-header">
                    <div class="phase-number recognize">1</div>
                    <div>
                        <div class="phase-title">RECOGNIZE</div>
                        <div class="phase-subtitle">Comprehensive Awareness & Acknowledgment</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Active Listening (0.9)</span>
                        <span class="enhancement-tag">Emotional Intelligence (0.9)</span>
                        <span class="enhancement-tag">Chain of Thought (0.7)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Listen: Complete information gathering</li>
                        <li>Acknowledge: Verify understanding</li>
                        <li>Clarify: Address gaps in understanding</li>
                        <li>Respond: Provide initial recognition</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="recognize-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Enhanced Key Questions</h5>
                        <ul class="detail-list">
                            <li>"Help me understand the complete impact of my actions"</li>
                            <li>"What emotions and thoughts did this create for you?"</li>
                            <li>"How has this affected your sense of safety/trust/wellbeing?"</li>
                            <li>"What aspects of the harm am I not yet fully grasping?"</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 2: EXAMINE -->
            <div class="phase-card" onclick="toggleDetails('examine')">
                <div class="phase-header">
                    <div class="phase-number examine">2</div>
                    <div>
                        <div class="phase-title">EXAMINE</div>
                        <div class="phase-subtitle">Logical Analysis & Objective Evaluation</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Chain of Reasoning (0.9)</span>
                        <span class="enhancement-tag">Bias Mitigation (0.9)</span>
                        <span class="enhancement-tag">Chain of Thought (0.8)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Logical Analysis: Systematic reasoning</li>
                        <li>Bias Detection: Objective self-assessment</li>
                        <li>Impact Assessment: Comprehensive evaluation</li>
                        <li>Pattern Analysis: Underlying issues</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="examine-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Bias Mitigation Checklist</h5>
                        <ul class="detail-list">
                            <li>Minimization bias: "It wasn't that bad"</li>
                            <li>Intent fallacy: "I didn't mean to hurt anyone"</li>
                            <li>Comparative bias: "Others have done worse"</li>
                            <li>Victim blaming: "They're too sensitive"</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 3: PREPARE -->
            <div class="phase-card" onclick="toggleDetails('prepare')">
                <div class="phase-header">
                    <div class="phase-number prepare">3</div>
                    <div>
                        <div class="phase-title">PREPARE</div>
                        <div class="phase-subtitle">Authentic Apology & Restoration Plan</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Wisdom-Understanding (0.9)</span>
                        <span class="enhancement-tag">Memory Context (0.8)</span>
                        <span class="enhancement-tag">Emotional Intelligence (0.8)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Wisdom Processing: Intuitive understanding</li>
                        <li>Understanding Processing: Analytical structure</li>
                        <li>Synthesis Integration: Combine elements</li>
                        <li>Memory Integration: Apply learning</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="prepare-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Enhanced Components</h5>
                        <ul class="detail-list">
                            <li>Acknowledgment Statement with emotional intelligence</li>
                            <li>Impact Recognition with wisdom-understanding</li>
                            <li>Responsibility Acceptance with bias mitigation</li>
                            <li>Change Commitment with memory context</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 4: ARTICULATE -->
            <div class="phase-card" onclick="toggleDetails('articulate')">
                <div class="phase-header">
                    <div class="phase-number articulate">4</div>
                    <div>
                        <div class="phase-title">ARTICULATE</div>
                        <div class="phase-subtitle">Authentic Delivery with Emotional Awareness</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Active Listening (0.9)</span>
                        <span class="enhancement-tag">Emotional Intelligence (0.9)</span>
                        <span class="enhancement-tag">Chain of Thought (0.8)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Safe Space Creation: Optimal conditions</li>
                        <li>Authentic Delivery: Genuine expression</li>
                        <li>Responsive Communication: Real-time adaptation</li>
                        <li>Complete Expression: Thorough coverage</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="articulate-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Enhanced Structure</h5>
                        <ul class="detail-list">
                            <li>"I acknowledge that I..." - Specific actions</li>
                            <li>"This caused..." - Impact recognition</li>
                            <li>"I understand that..." - Deep implications</li>
                            <li>"I will..." - Specific changes</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 5: IMPLEMENT -->
            <div class="phase-card" onclick="toggleDetails('implement')">
                <div class="phase-header">
                    <div class="phase-number implement">5</div>
                    <div>
                        <div class="phase-title">IMPLEMENT</div>
                        <div class="phase-subtitle">Systematic Tracking & Learning Integration</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Memory Context (0.9)</span>
                        <span class="enhancement-tag">Chain of Reasoning (0.8)</span>
                        <span class="enhancement-tag">Wisdom-Understanding (0.7)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Immediate Corrections: Urgent changes</li>
                        <li>Systematic Changes: Comprehensive plan</li>
                        <li>Progress Tracking: Monitor development</li>
                        <li>Learning Integration: Sustainable change</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="implement-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Timeline Actions</h5>
                        <ul class="detail-list">
                            <li>Immediate (0-2 weeks): Cease harmful behaviors</li>
                            <li>Short-term (2 weeks - 3 months): Execute amends</li>
                            <li>Long-term (3+ months): Maintain patterns</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Phase 6: RESTORE -->
            <div class="phase-card" onclick="toggleDetails('restore')">
                <div class="phase-header">
                    <div class="phase-number restore">6</div>
                    <div>
                        <div class="phase-title">RESTORE</div>
                        <div class="phase-subtitle">Rebuild Trust & Restore Relationships</div>
                    </div>
                </div>

                <div class="cognitive-enhancements">
                    <h4>Cognitive Enhancements</h4>
                    <div class="enhancement-tags">
                        <span class="enhancement-tag">Wisdom-Understanding (0.9)</span>
                        <span class="enhancement-tag">Emotional Intelligence (0.9)</span>
                        <span class="enhancement-tag">Memory Context (0.8)</span>
                        <span class="enhancement-tag">Active Listening (0.8)</span>
                    </div>
                </div>

                <div class="key-processes">
                    <h4>Key Processes</h4>
                    <ul class="process-list">
                        <li>Trust Rebuilding: Systematic confidence restoration</li>
                        <li>Relationship Healing: Emotional restoration</li>
                        <li>Pattern Prevention: Sustainable change</li>
                        <li>Community Restoration: Broader healing</li>
                    </ul>
                </div>

                <button class="expand-btn">View Details</button>

                <div id="restore-details" class="expanded-details">
                    <div class="detail-section">
                        <h5>Trust Rebuilding Indicators</h5>
                        <ul class="detail-list">
                            <li>Consistency between commitments and actions</li>
                            <li>Transparency in communication</li>
                            <li>Respect for boundaries</li>
                            <li>Patience with healing timelines</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhancement Matrix -->
        <div class="enhancement-matrix desktop-center">
            <div class="matrix-title">Cognitive Enhancement Configuration Matrix</div>
            <table class="matrix-table">
                <thead>
                    <tr>
                        <th>Phase</th>
                        <th>AL</th>
                        <th>MC</th>
                        <th>CoT</th>
                        <th>CoR</th>
                        <th>BM</th>
                        <th>WU</th>
                        <th>EI</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>RECOGNIZE</strong></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                    </tr>
                    <tr>
                        <td><strong>EXAMINE</strong></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                    </tr>
                    <tr>
                        <td><strong>PREPARE</strong></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                    </tr>
                    <tr>
                        <td><strong>ARTICULATE</strong></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-medium">0.6</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                    </tr>
                    <tr>
                        <td><strong>IMPLEMENT</strong></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                    </tr>
                    <tr>
                        <td><strong>RESTORE</strong></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-high">0.8</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-medium">0.7</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                        <td><span class="matrix-value value-high">0.9</span></td>
                    </tr>
                </tbody>
            </table>
            <div style="margin-top: 15px; font-size: 0.9rem; color: var(--text-tertiary);">
                <strong>Legend:</strong> AL = Active Listening, MC = Memory Context, CoT = Chain of Thought, 
                CoR = Chain of Reasoning, BM = Bias Mitigation, WU = Wisdom-Understanding, EI = Emotional Intelligence
            </div>
        </div>
    </div>

    <script>
        // Theme management
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            document.documentElement.setAttribute('data-theme', newTheme);

            // Update theme toggle button
            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');

            if (newTheme === 'dark') {
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light Mode';
            } else {
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark Mode';
            }

            // Store preference
            localStorage.setItem('theme', newTheme);
        }

        // Initialize theme
        function initializeTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);

            const themeIcon = document.getElementById('theme-icon');
            const themeText = document.getElementById('theme-text');

            if (savedTheme === 'dark') {
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light Mode';
            } else {
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark Mode';
            }
        }

        function toggleDetails(phaseId) {
            const details = document.getElementById(phaseId + '-details');
            const btn = details.previousElementSibling;
            
            if (details.classList.contains('show')) {
                details.classList.remove('show');
                btn.textContent = 'View Details';
            } else {
                // Hide all other details first
                const allDetails = document.querySelectorAll('.expanded-details');
                const allBtns = document.querySelectorAll('.expand-btn');
                allDetails.forEach(detail => detail.classList.remove('show'));
                allBtns.forEach(button => button.textContent = 'View Details');
                
                // Show current details
                details.classList.add('show');
                btn.textContent = 'Hide Details';
            }
        }

        // Add some smooth scrolling and animation effects
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            
            const cards = document.querySelectorAll('.phase-card');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, { threshold: 0.1 });

            cards.forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(30px)';
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
                observer.observe(card);
            });
        });

        // Chatbot Functions
        function toggleChatWidget() {
            const chatPanel = document.getElementById('agent-panel');
            const chatButton = document.getElementById('floating-chat-button');
            if (chatPanel.classList.contains('active')) {
                chatPanel.classList.remove('active');
                chatButton.classList.remove('hidden');
            } else {
                chatPanel.classList.add('active');
                chatButton.classList.add('hidden');
            }
        }

        function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();

            if (message) {
                addChatMessage(message, 'user');
                input.value = '';

                setTimeout(() => {
                    addChatMessage('Thank you for reaching out! I\'m here to support your REPAIR journey. This visual framework shows how healing unfolds through understanding, repairing, and restoring relationships. What would you like to explore?', 'assistant');
                }, 1000);
            }
        }

        function addChatMessage(content, sender) {
            const messagesContainer = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${sender}`;

            const avatar = document.createElement('div');
            avatar.className = `chat-avatar ${sender}`;
            avatar.textContent = sender === 'assistant' ? '‚ù§Ô∏è' : 'üë§';

            const bubble = document.createElement('div');
            bubble.className = `chat-bubble ${sender}`;
            bubble.textContent = content;

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(bubble);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Initialize chatbot
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                addChatMessage('Welcome to the REPAIR Visual Framework! ‚ù§Ô∏è I can help you understand the healing phases, explain the science behind reconciliation, and guide you through this transformational journey. How can I assist you today?', 'assistant');
            }, 500);

            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendChatMessage();
                    }
                });
            }
        });
    </script>

    <!-- Floating Chat Button -->
    <button id="floating-chat-button" class="floating-chat-button" onclick="toggleChatWidget()" aria-label="Open chat">
        ‚ù§Ô∏è
    </button>

    <!-- Chat Panel -->
    <div id="agent-panel" class="chat-widget-panel">
        <div class="chat-widget-header">
            <div class="chat-header-title">
                <span class="chat-icon">‚ù§Ô∏è</span>
                <span>REPAIR Guide</span>
            </div>
            <div class="chat-header-actions">
                <button class="chat-action-btn" onclick="toggleChatWidget()" aria-label="Close">
                    ‚úï
                </button>
            </div>
        </div>
        <div class="chat-widget-body">
            <div id="chat-messages" class="chat-messages"></div>
            <div class="chat-input-area">
                <textarea id="chat-input" class="chat-input"
                       placeholder="Ask about healing phases, reconciliation strategies, or the REPAIR process..."
                       aria-label="Chat input"></textarea>
                <button class="send-button" onclick="sendChatMessage()" aria-label="Send message">
                    ‚û§
                </button>
            </div>
        </div>
    </div>
</body>
</html>
